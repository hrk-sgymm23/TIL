# コンテナ基礎/実践

## Docker実践

## bind mountを使った定義ファイル
 - `bind mount`を使用し、host側のファイルやフォルダをコンテナにマウント
   - `source`はyamlファイルがあるフォルダからの相対パス
   - `target`はマウントしたい先のコンテナ内のパス
   - `type`はbind mountするので`bind`を指定

## docker composeのwatch機能
- ファイルを編集/保存した際に実行中のComposeサービスを自動的に更新
  - コンテナ内に以下のコマンドが含まれている必要がある
    - `stat`
    - `mkdir`
    - `rmdir`
- `watch`機能を有効化するには`docker compose up --watch`を実行

### Watch機能のアクション
- `sync`
  - ホスト上のファイルの変更をサービスコンテナ内と一致させる
  - ホットリロードが必要な場面で最適
  - 一般的に`bind mount`の代わりに利用される
- `rebuild`
  - イメージのビルドを行い実行中のサービスコンテナを置き換え
  - 実行にコンパイルが必要な言語などに最適
- `sync`+`restart`
  - サービスコンテナとファイル同期をし、コンテナを再起動
  - 設定ファイルが更新されプロセスの再起動を行いたい場合に有効

### Watch機能のファイルパスの扱い
- ファイルパスは以下に従う
- 全てのパスはプロジェクトフォルダから早退パスとして扱われる
- フォルダは再起的に監視
- `.dockerignore`のルールが適用
  - 一般的なIDEの設定ファイルやバックアップファイルは一般的に除外
  - `.git`フォルダは除外

### Watch機能とbind mountの比較
- watch機能はbind mountを置き換えるものではない

- bind mountとの使い分け
  - bind mount...単純なコンテナとのファイル共有
  - watch機能...ファイル共有で細かな制御が必要な場合
- 
