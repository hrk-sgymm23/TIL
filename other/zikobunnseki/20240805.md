# 提出物

# **一旦書き殴ってブラッシュアップ**

＜課題＞
なぜその課題を解決しなければならなかったのか、
その課題がプロジェクトにどのような影響を及ぼしていたのかご記入ください。

＜対応内容＞
あなたが取り組んだ技術的なアプローチについて説明してください。
- どんな課題があり
- どのような考察や仮説から
- 技術的な解決策を講じたのか
の情報を満たせるようなエピソードであることが望ましいです。

＜結果＞
取り組みの結果について説明してください。
ご自身がどのような成果や変化をもたらしたのか、
プロジェクトの課題解決や目標にどのように貢献したのかをご記入ください。


# 課題

## レンタル
私が開発・運用保守、担当していたレンタルサービスでは商品をレンタルする期間が限られており、お客様がレンタルする期間を延長すると自動的にシステム側でレンタル延滞料金が請求される仕組みになっておりました。
しかし実際はお客様へ貸し出すに当たって中継のお店がありそのお店のオペレーションや商品配送遅延の問題でレンタル開始期間を過ぎてからレンタルを開始しそこから決められた固定期間レンタルするので勝手にレンタル延滞料金が請求されその都度、請求を請求機能を担っているStripeのコンソールから調べそのお客様のものか確認し、手動でシステム運営スタッフの方が返金するというフローを踏んでいました。


## データ基盤

# 対応内容

## レンタル
<どんな課題があり>
- 上記課題にてシステム運営者の方がその延滞料金が発生したユーザに実際に延滞したのか何か問題があって延滞になったのか確認する必要があり、スタッフの方が確認業務と返金業務に追われていた点、そしてエンドユーザーの方には何か事情があって延滞している場合に一度延滞料金が請求され、その際に通知が飛ぶため困惑してしまうというケースがありました。

<どのような考察や仮説から>
- 上記問題を改善すべく既存の延滞請求機能を見直しました。具体的には延滞した時点で延滞料金の請求が実行される機能に問題があるという点でした。

<技術的な解決策を講じたのか>
- 請求のタイミングを変更できないかという観点で調査を行なっていると、Stripeには請求を直接実行する機能と請求をドラフトで作成し任意のタイミングで請求を行える機能がありました。
- 改修としましては延滞が確定した時点の直接Railsのバッチ経由で請求実行していたものを請求のドラフトを作成するように変更し、このタイミングで運営スタッフとレンタル先の店舗の方へ延滞されたお客様情報を記載したメールをActionMailerを用いて実装しました。また任意のタイミングで請求を行うためにAPIを改修し運営スタッフ専用ページから請求のドラフトが作られている状態の場合は請求が行えるよう修正しました。またその際、API機能改修に付随してUIの改修も行いました。
- また今回の機能改修において想定していたオペレーションから追加になるため、運営スタッフ、レンタル先店舗スタッフの方向けにスライド資料を作成し、新規オペレーションについてご説明しました。


## データ基盤

# 結果

## レンタル
- 上記施策を行うことで運営スタッフの方の業務がシンプルになり、無駄な作業を減らすことができました。以前は運営スタッフと店舗スタッフでのやりとりの往復があり一人の方を対応するのにも時間がかかっておりました。
- また運営スタッフの方から開発チームのお問合せもなくなりその分工数を他の機能開発や対応の時間に回すことができるようになりました。


## データ基盤




# ChatGptによる修正

<課題内容に対する答え>

私が開発・運用保守を担当していたレンタルサービスでは、商品のレンタル期間が限られており、お客様が期間を延長すると、自動的にシステムがレンタル延滞料金を請求する仕組みでした。しかし、実際には中継店舗のオペレーションや配送遅延の影響で、レンタル開始が遅れ、その結果、予定より遅れてレンタルを開始したお客様に対しても延滞料金が請求される事態が発生していました。このような場合、Stripeのコンソールから請求を確認し、手動で返金対応を行う必要があり、システム運営スタッフに大きな負担がかかっていました。

<対応内容の回答>

<どんな課題があり>

上記の課題により、システム運営スタッフは、延滞料金が発生したユーザーが実際に延滞したのか、または他の要因で延滞が発生したのかを確認する必要がありました。この確認業務と返金業務がスタッフの負担となり、またエンドユーザーに対しても不必要な延滞料金の請求が行われることで、混乱を招いていました。


<どのような考察や仮説から>

この問題を解決するため、既存の延滞請求機能を見直し、延滞時点での自動請求が問題であると考えええ安泰を確認した際の新機能とオペレーション追加が必要ではないかと考えました。

<技術的な解決策を講じたのか>

請求のタイミングを変更するにあたって調査を行う中で、Stripeには直接請求を実行する機能と、請求をドラフトとして作成し任意のタイミングで実行できる機能があることがわかりました。
そこで、延滞が確定した時点での直接請求を、ドラフト作成に変更し、運営スタッフおよびレンタル店舗に延滞情報を通知する仕組みをActionMailerを用いて実装しました。また、任意のタイミングで請求を行うためのAPIを改修し、運営スタッフ専用ページから請求を管理できるようにUIも併せて改善しました。
さらに、新しいオペレーションをスムーズに導入するために、運営スタッフとレンタル店舗向けにスライド資料を作成し、詳細な説明を行いました。

<結果に回答>

上記の施策により、運営スタッフの業務が簡素化され、今まで延滞発生から対応完了あで1週間ほどかかって業務を1~2日に削減することができました。スタッフの方からも要望に対し、機能・オペレーションの提案から実際に機能リリース後の説明まで対応してもらえて助かったと良いフィードバックをいただけました。
さまた運営スタッフから開発チームへの問い合わせも減少し、その分、他の機能開発や対応にリソースを集中させることができるようになりました。
