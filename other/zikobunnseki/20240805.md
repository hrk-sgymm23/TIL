# 提出物

# **一旦書き殴ってブラッシュアップ**

＜課題＞
なぜその課題を解決しなければならなかったのか、
その課題がプロジェクトにどのような影響を及ぼしていたのかご記入ください。

＜対応内容＞
あなたが取り組んだ技術的なアプローチについて説明してください。
- どんな課題があり
- どのような考察や仮説から
- 技術的な解決策を講じたのか
の情報を満たせるようなエピソードであることが望ましいです。

＜結果＞
取り組みの結果について説明してください。
ご自身がどのような成果や変化をもたらしたのか、
プロジェクトの課題解決や目標にどのように貢献したのかをご記入ください。


# 課題

## レンタル
私が開発・運用保守、担当していたレンタルサービスでは商品をレンタルする期間が限られており、お客様がレンタルする期間を延長すると自動的にシステム側でレンタル延滞料金が請求される仕組みになっておりました。
しかし実際はお客様へ貸し出すに当たって中継のお店がありそのお店のオペレーションや商品配送遅延の問題でレンタル開始期間を過ぎてからレンタルを開始しそこから決められた固定期間レンタルするので勝手にレンタル延滞料金が請求されその都度、請求を請求機能を担っているStripeのコンソールから調べそのお客様のものか確認し、手動でシステム運営スタッフの方が返金するというフローを踏んでいました。


## データ基盤

# 対応内容

## レンタル
- 上記課題にてシステム運営者の方がその延滞料金が発生したユーザに実際に延滞したのか何か問題があって延滞になったのか確認する必要があり、スタッフの方が確認業務と返金業務に追われていた点、そしてエンドユーザーの方には何か事情があって延滞している場合に一度延滞料金が請求され、その際に通知が飛ぶため困惑してしまうというケースがありました。
- 上記問題を改善すべく既存の延滞請求機能を見直しました。具体的には延滞した時点で延滞料金の請求が実行される機能に問題があるという点でした。
- 請求のタイミングを変更できないかという観点で調査を行なっていると、Stripeには請求を直接実行する機能と請求をドラフトで作成し任意のタイミングで請求を行える機能がありました。
- 改修としましては延滞が確定した時点の直接Railsのバッチ経由で請求実行していたものを請求のドラフトを作成するように変更し、このタイミングで運営スタッフとレンタル先の店舗の方へ延滞されたお客様情報を記載したメールをActionMailerを用いて実装しました。また任意のタイミングで請求を行うためにAPIを改修し運営スタッフ専用ページから請求のドラフトが作られている状態の場合は請求が行えるよう修正しました。またその際、API機能改修に付随してUIの改修も行いました。
- また今回の機能改修において想定していたオペレーションから追加になるため、運営スタッフ、レンタル先店舗スタッフの方向けにスライド資料を作成し、新規オペレーションについてご説明しました。


## データ基盤

# 結果

## サブスク

## データ基盤
