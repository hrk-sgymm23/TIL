# #30

## Lambda Cloudwatchメトリクスフィルター
- CloudWatch logsを用いてLambdaのログからからAPIオペレーション名、レスポンス名、コードUserAgent由来のバージョンを別に動的ディメンション付きメトリクスを生成、集計できる
- CloudWatchメトリクスフィルターはlambdaが出力するJSON構造化ログからAPIオペレーション、レスポンスコード、UserAgentを抽出し、APIオペレーションごとに増分できる

- X-Rayはグループ単位での標準メトリクス(件数やレートなど)をCloudwatchに公開する機能でありアプリのバージョンやレスポンスコードといった任意ディメンション付きのメトリクスを実行発行できない

## Config マネージドルールrestricted-ssh
- restricted-sshでポート22の0.0.0.0/0への全開放を検出しSNSへの通知と構成スナップショットの取得が可能


## CloudWatch Logsデータ保護ポリシー
- データ保護ポリシーではデータをカスタムデータ識別子の正規表現で検出しマスクすることが可能
- マスクは保存データを変更せず表示時に適用され、マスク解除にはIAM、logs:ummask権限が必要


## CloudFrontオリジンフェイルオーバー  OpenSearchクラスター間レプリケーション
- CloudfrontオリジンフェイルオーバーはプライマリーのALBの障害の際にDRリージョンへALBトラフィックを自動切り替えする
- OpenSerachServiceは、DRリージョンに新規ドメインを作成しクラスタレプリケーションでインデックスでインデックスを継続複製する。

- OpenSearchServiceのマルチAZは同一リージョン内の冗長化機能であり、スタンバイモードという機能はない
- クロスリージョンでは最新状態を保つにはドメインを分けてcross-cluster replicationを構成する必要がある

## Kinesis DataStream Cloudwatch GetRecords.IteratorAgeMillseconds
- CloudWatchのGetRecords.IteratorAgeMillsecondsではコンシューマの遅延を定量化するメトリクス
- 上記メトリクスを閾値としてEC2上のコンシューマを水平方向にスケーリングするとコンシューマの並列が直ちに増加し各シャードの取得、処理速度を向上してバックログを解消できる


# #31

## CloudFront オリジンフェイルオーバーによる高可用性の最適化
- CloudFrontでオリジングループを設定しHTTP5xxコードに基づいてフェイルオーバーが可能
