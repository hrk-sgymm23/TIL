# コスト最適化 TrustedAdovisorチェック結果をCloudWatch Eventsでモニタリングする

- Trusted Advisorを利用することで稼働率が低いインスタンスを追跡することに役立つ
- CloudWatch EventsはTrustedAdvisorに基づいてイベントをトリガーするために使用できる
- Lambdaを使用して監査レポートを作成し稼働率が低いインスタンスを削除することでコストを削減できる

# 僅かなダウンタイムでMySQLのバージョンをアップグレード
- メジャーバージョンアプグレードの推奨アプローチは既存のデータベースからリードレプリカを作成すること
- リードレプリカをアップグレードし、アップグレードで正常に動作することを確認してからプライマリに昇格させる

- AWS::RDS::DBInstanceがサポートするプロパティはEngineVersion。DBEngineversionでないことに注意

# ECS サービスの更新
- ECSが新しいイメージを使用するためにタスク定義のダイジェストを更新することができる。
- 「サービスの設定」のページにてサービスの情報はあらかじめ入力されている。タスク定義、プラットフォームバージョン、デプロイ設定、タスク数の必要数のいずれかを選択し更新

# S3イベント x Lambda ロールの確認
- LambdaはS3イベントをトリガーしてユーザーのロールを確認できるように設定できる

# CodeDeploy デプロイターゲットAutoScalingグループ
- AutoScalingをデプロイ先として指定可能
  - インスタンス単位だけでなくグループ単位で指定のイメージ
- CodeDeployエージェントはEC2インスタンスでデプロイされたアプリケーションのインストール、起動、更新などを行う
- エージェントがインストールされているインスタンス内でCodeDeployがエージェントを介して実行する。
- その際にインスタンスがCodeDeployへアクセスできるようIAMロールを割り当てる必要がある

# CloudFormation UpdatePolicy属性
- UpdatePolicy属性を指定してリソースに対する更新処理を指定できる
- Route53を使用してアクティぶなALBへ切り替える...ダウンタイムゼロのBGデプロイを提供できる！

# CloudFormation カスタムリソース
- カスタムリソースではAWSで定義できるプロパティはservicetokenが必要
- カスタムリソースを使用するとテンプレートにカスタムのプロビジョニングロジックを設定しユーザースタックを作成、更新、削除するたびにCloudFormationがカスタムリソースを実行する

# リソース変更の監視 Config
- TrusetdAdvisorではSDK、CLI、コンソールを解す必要があり面倒
- Configにはリソース間の関係と設定が含まれる
